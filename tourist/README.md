# Tourist ‡∏ô‡∏±‡∏Å‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß

[üéâ solution.cpp](./tourist.cpp)

<img width="500" alt="image" src="https://github.com/krist7599555/pretoi19/assets/19445033/e69a1365-1ab6-40da-9cad-01d075adbb66">

## Oveserve 1 - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 224 ‡∏Å‡∏•‡∏∏‡πà‡∏°

‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ï‡∏£‡∏á‡πÜ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏•‡∏¢‡∏à‡∏∞‡∏î‡∏π‡∏¢‡∏≤‡∏Å‡∏°‡∏≤‡∏Å ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å input ‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡πâ `group_ids <= 100,000`. ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏Ñ‡∏¥‡∏î‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢ group ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡∏ã‡πâ‡∏≥

‡πÄ‡∏•‡∏¢‡∏´‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢ ‡πÄ‡∏ä‡πà‡∏ô

```python
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 1 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 2 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 3 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 4 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 5 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 6 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ 7 ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
..
‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏µ n ‡∏Ñ‡∏ô 1 ‡∏Å‡∏•‡πà‡∏∏‡∏°
```

‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏µ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°(n) ‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 224 `~sqrt(n)`

> ```cpp
> 1+2+3+4+5...+n <= 100,000
> n*(n+1)/2      <= 100,000
> n              <= 223.60679775
> ```

‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏¥‡∏î‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á `L[i], R[i]` ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏õ‡πá‡∏ô ‡∏à‡∏∏‡∏î‡πÉ‡∏î‡πÜ‡πÅ‡∏ó‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 224 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á

## Observe 2 - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ node ‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏õ‡∏ñ‡∏∂‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡πÑ‡∏ß‡πÜ

‡∏Å‡∏≤‡∏£‡∏à‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Å‡∏£‡∏≤‡∏ü‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÑ‡∏´‡∏°‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏ï‡πá‡∏°‡πÜ‡∏ó‡∏∏‡∏Å‡πÄ‡∏™‡πâ‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å ‡∏°‡∏±‡∏ô‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ. ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î‡πÉ‡∏ô‡∏°‡∏∏‡∏°‡∏Å‡∏•‡∏±‡∏ö ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏≤‡∏ü‡∏ï‡∏≠‡∏ô‡∏à‡∏ö‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏ñ‡∏π‡∏Å‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ‡∏£‡∏ß‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡∏à‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏î‡∏µ‡∏¢‡∏ß

> ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ú‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å technique ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡∏°‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏ô‡∏ú‡∏• ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ß‡πà‡∏≤ `Offline Algorithm` ‡∏´‡∏£‡∏∑‡∏≠ `Reverse Engineer` ‡πÅ‡∏ï‡πà‡πÉ‡∏Ñ‡∏£‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ô‡∏∞

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏≤‡∏° connectivity ‡πÄ‡∏õ‡πá‡∏ô ‡∏ï‡πà‡∏≠‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡∏≤‡∏° connectivity ‡∏Å‡πá‡∏à‡∏∞‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö concept ‡∏Ç‡∏≠‡∏á set-union ‡πÄ‡∏•‡∏¢

## Observe 3 - ‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏î‡πâ‡∏ß‡∏¢ DSU (Disjoint Set Union)

> [Disjoint Set Unions - Union Find Algorith Tutorial](https://cp-algorithms.com/data_structures/disjoint_set_union.html)

<img width="500" alt="image" src="https://github.com/krist7599555/pretoi19/assets/19445033/99c0703b-4fcf-4db2-a286-a305d5137de5">

1. ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡∏£‡∏≤‡∏ü‡∏î‡πâ‡∏ß‡∏¢ `dsu` ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ node ‡πÑ‡∏´‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏´‡∏≤‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢
1. ‡∏ï‡πà‡∏≠‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° ‡∏ó‡∏µ‡πà**‡πÑ‡∏°‡πà‡∏°‡∏µ**‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç policy `L[i], R[i]` ‡∏•‡∏á‡πÉ‡∏ô `dsu`
1. ‡∏ó‡∏≥‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤ (backward)
   1. `cmd=1` ‡∏Ñ‡πà‡∏≠‡∏¢‡πÜ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡∏≠‡∏ô‡πÑ‡∏Ç‡∏•‡∏á‡πÑ‡∏õ
   1. `cmd=2` ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏ß‡πâ‡∏ß‡πà‡∏≤ `u, v` ‡πÄ‡∏î‡∏¥‡∏ô‡πÑ‡∏õ‡∏´‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ

‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ô‡∏µ‡πâ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏ó‡πà‡∏≤ `O(Edge)`

## Time Complexity

- ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏° `O(100,000)` ‡∏î‡πâ‡∏ß‡∏¢ bucket sort
- ‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô `O(100,000)`
- ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ 224 ‡∏Å‡∏•‡∏∏‡πà‡∏° `O(sqrt(GroupIds))`
  - ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏° ‡∏™‡∏£‡πâ‡∏≤‡∏á `dsu` ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î `O(Edge)` ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
  - `dsu.merge` ‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ `O(log Node)`

‡∏£‡∏ß‡∏°

```python
= O(100,000 + sqrt(GroupIds) * Edge * log Node)
= O(sqrt(GroupIds) * Edge * log Node)
```
